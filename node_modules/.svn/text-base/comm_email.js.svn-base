
/*
 * @class AD.Comm.Email
 * @parent AD.Comm
 * 
 * An object to send email using the node mailer module
 */
var actualObj = require('mailer');

/*
 * @function sendMail
 * 
 * ##sendMail
 * A function taking in email parameters in the data object and using actualObj to send the email.
 * 
 * @param {Object} req
 * @param {Object} res
 * @param {Object} data
 */
exports.sendMail = function (req, res, data) {

    //// build our response object:
    var response = {
        success:'true',
        data: data
    };
    
    var mailhost = typeof AD.Defaults.emailHost == 'undefined' ? "securemail.zteam.biz" : AD.Defaults.emailHost;
    var mailport = typeof AD.Defaults.emailPort == 'undefined' ? "25" : AD.Defaults.emailPort;
    var maildomain = typeof AD.Defaults.emailDomain == 'undefined' ? "localhost" : AD.Defaults.emailDomain;

    actualObj.send({
	  host : mailhost,              // smtp server hostname
	  port : mailport,                     // smtp server port
	  domain : maildomain,            // domain used by client to identify itself to server
	  to : data['to'],
	  from : data['from'],
	  subject : data['subject'],
	  body: data['body']
	  //authentication : "login",        // auth login is supported; anything else is no auth
	  //username : data['smtpuser'],       // Base64 encoded username
	  //password : data['smtppass']        // Base64 encoded password
	},
	
	function(err, result){
	  if(err) { 
		  next(err); 
	  }
	  else { 
		  next(); 
	  }
	  
	});
    

}
